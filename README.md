# 程序设计训练

这些是THU2017年小学期程序设计训练的大作业。

## Week 1: Sudoku Game

### 简介

Sudoku 是一款利用 Qt 实现的数独游戏，提供了多达 10 个难度的关卡选择，同时还有丰富的功能来帮助玩家更加高效地求解数独问题，例如候选数、高亮相同数字、高亮选中的行列、撤销当前操作以及提示等功能。玩家还可以手动输入数独题目利用 Sudoku 帮助求解。

除了传统 9x9 的数独游戏以外，还提供了更高难度的 16x16 的数独游戏。

![](https://github.com/miskcoo/programming-training-assignment/blob/sudoku/sudoku/doc/sudoku-3c.png?raw=true)

### 基本功能

Sudoku提供了多个方便的按钮：

* **新游戏**：玩家可以开始一局新的游戏。
* **重玩**：玩家可以重新开始本局游戏。
* **暂停**：玩家可以暂停该局游戏（即暂停计时）。
* **提示**：如果当前已经确定的数都是正确的，玩家将会得到一个未填空格的正确数字；如果当前已经确定的数和答案矛盾，导致整个数独无解，那么所有与答案矛盾的数字将会被粗体标出。
* **清除**：清除当前选中格子的所有数字。
* **撤销**：撤销前一步的操作，以及取消撤销（最多可支持50步撤销）。

同时可以通过菜单来实现多达10种难度的游戏选择，可以求解任意用户输入的数独问题。

玩家在空格中填入的数字分为确定数（采用正常大小的字体表示）以及候选数（采用小号字体表示）。确定数只能存在一个，候选数可以存在多个，并且确定数和候选数不能同时存在。

玩家可以通过多种方式进行格子的选择：

* 鼠标直接点击格子进行选中。
* 键盘方向键来进行当前选中格子的切换。
* Tab键快速切换到下一个格子。

玩家可以用鼠标右键点击格子来对其进行标记。

玩家在选中一个格子之后，如果该格子的数字已经确定，那么所有与该数相同的数将会被加粗显示，以方便确认是否满足数独的条件。同时，所有与该格在相同行或列的格子都会被高亮显示。此外，无论该格子数字确定与否，右侧数字列表中该格子的所有数都会被加粗。

玩家可以通过多种方式在空格中填入数字：

* 键盘直接输入数字将填入对应的确定数，如果Ctrl键被按下，那么填入的将会是候选数。
* 鼠标点击右侧数字列表填入。使用鼠标左键点击将会填入确定数，右键点击则会填入候选数。

玩家也可以通过多种方式在空格中填入数字：

* 键盘删除键删除格子中的一个数字。
* 鼠标点击右侧数字列表已经选中的数进行删除。
* “清除”功能键来清除该格子所有的数字。

### 游戏生成算法
我们认为一个数独游戏的难度可以根据行列空格数的最大值以及给定数字的数量来确定。行列空格数的最大值越小玩家拥有的信息量就越多，同样给定数字越多玩家也能获得更多的信息。

在我们的难度中，最简单的关卡给出的数字至少有50个，并且行列空格数不会超过4个。然而，在最困难的关卡中，最少只会给出20个数字，并且可能会有某些行或列全部是空格。在最简单和最困难中间这两个影响难度的因素平滑过渡。

为了生成一个满足条件的数独，可以按照以下步骤来实现：

1. 在空白棋盘随机填入数十个数。
2. 利用求解算法获得一个合法解，如果不存在合法解，转到1。
3. 生成一个随机的格子排列。
4. 按照这个序列来尝试一个个删除所填入的数字，如果删除后能保证解唯一并且满足之前的条件，那么就删除，否则不删除。
5. 如果删除了足够的数字，则返回。否则跳到1。

为了实现快速的数独问题求解，我们利用Dancing Link来优化搜索。

### 参考资料
[1]: XUE, Y.H., JIANG, B.B., Li, Y., YAN, G.F. and SUN, H.F., 2009. Sudoku puzzles generating: From easy to evil. Mathematics in practice and theory, 21(000).
[2]: Knuth, D.E., 2000. Dancing links. arXiv preprint cs/0011047.
